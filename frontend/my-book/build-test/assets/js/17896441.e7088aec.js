"use strict";(globalThis.webpackChunkmy_book=globalThis.webpackChunkmy_book||[]).push([[8401],{8551:(e,n,r)=>{r.r(n),r.d(n,{default:()=>j});var t=r(6540),s=r(8310),a=r(8478),i=r(223),l=r(7716),o=r(3092),c=r(2239),d=r(4848);const h=({content:e,className:n=""})=>{const[r,s]=(0,t.useState)(e);(0,t.useEffect)(()=>{s(e)},[e]);const a={code({node:e,inline:n,className:r,children:t,...s}){const a=/language-(\w+)/.exec(r||"");return!n&&a?(0,d.jsx)("pre",{className:r,...s,children:(0,d.jsx)("code",{className:r,children:t})}):(0,d.jsx)("code",{className:r,...s,children:t})},a:({node:e,href:n,children:r,...t})=>(0,d.jsx)("a",{href:n,target:n?.startsWith("http")?"_blank":void 0,rel:n?.startsWith("http")?"noopener noreferrer":void 0,...t,children:r})};return(0,d.jsx)("div",{className:`markdown-renderer ${n}`,children:(0,d.jsx)(l.oz,{remarkPlugins:[o.A],rehypePlugins:[c.A],components:a,children:r})})};var p=r(4586);const u=({chapterId:e,chapterContent:n,onPersonalize:r})=>{const{preferences:s,setPreferences:a,isPersonalized:l,getPersonalizedContent:o,setPersonalizedContent:c,isAuthenticated:u,loading:x,userBackground:m}=(0,i.usePersonalization)(),{siteConfig:j}=(0,p.A)(),g=j.customFields?.backendUrl||"http://localhost:8000",[f,v]=(0,t.useState)(!1),[y,b]=(0,t.useState)(null),[N,z]=(0,t.useState)(!1),C=l(e),_=o(e),w=(e,n)=>{a({...s,[e]:n})};return x?(0,d.jsx)("div",{className:"personalization-container",children:(0,d.jsx)("div",{className:"personalization-header",children:(0,d.jsxs)("button",{className:"personalize-btn",disabled:!0,children:[(0,d.jsx)("span",{className:"spinner"}),"Loading..."]})})}):u?(0,d.jsxs)("div",{className:"personalization-container",children:[(0,d.jsxs)("div",{className:"personalization-header",children:[(0,d.jsx)("button",{className:`personalize-btn ${C?"applied":""} ${f?"loading":""}`,onClick:async()=>{if(!C){v(!0),b(null);try{const t={chapter_content:n,user_preferences:s,chapter_id:e},a=await fetch(`${g}/personalize`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const i=await a.json();if(!i.personalization_applied||!i.personalized_content)throw new Error("Personalization was not applied successfully");c(e,i.personalized_content),r&&r(i.personalized_content)}catch(t){console.error("Personalization error:",t),b(t instanceof Error?t.message:"An error occurred during personalization")}finally{v(!1)}}},disabled:f||C,title:C?"Content already personalized":"Personalize this chapter based on your preferences",children:f?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"spinner"}),"Personalizing..."]}):C?(0,d.jsx)(d.Fragment,{children:"\u2705 Personalized"}):(0,d.jsx)(d.Fragment,{children:"\ud83c\udfaf Personalize Content"})}),(0,d.jsx)("button",{className:"preferences-toggle",onClick:()=>z(!N),title:"Adjust your learning preferences",children:N?"Hide Preferences":"Preferences"})]}),N&&(0,d.jsxs)("div",{className:"preferences-panel",children:[(0,d.jsxs)("div",{className:"preferences-grid",children:[(0,d.jsxs)("div",{className:"preference-item",children:[(0,d.jsx)("label",{htmlFor:"learning-style",children:"Learning Style:"}),(0,d.jsxs)("select",{id:"learning-style",value:s.learning_style,onChange:e=>w("learning_style",e.target.value),children:[(0,d.jsx)("option",{value:"visual",children:"Visual"}),(0,d.jsx)("option",{value:"auditory",children:"Auditory"}),(0,d.jsx)("option",{value:"reading/writing",children:"Reading/Writing"}),(0,d.jsx)("option",{value:"kinesthetic",children:"Kinesthetic"}),(0,d.jsx)("option",{value:"multimodal",children:"Multimodal"})]})]}),(0,d.jsxs)("div",{className:"preference-item",children:[(0,d.jsx)("label",{htmlFor:"experience-level",children:"Experience Level:"}),(0,d.jsxs)("select",{id:"experience-level",value:s.experience_level,onChange:e=>w("experience_level",e.target.value),children:[(0,d.jsx)("option",{value:"beginner",children:"Beginner"}),(0,d.jsx)("option",{value:"intermediate",children:"Intermediate"}),(0,d.jsx)("option",{value:"advanced",children:"Advanced"}),(0,d.jsx)("option",{value:"expert",children:"Expert"})]})]}),(0,d.jsxs)("div",{className:"preference-item",children:[(0,d.jsx)("label",{htmlFor:"difficulty",children:"Difficulty:"}),(0,d.jsxs)("select",{id:"difficulty",value:s.difficulty_preference,onChange:e=>w("difficulty_preference",e.target.value),children:[(0,d.jsx)("option",{value:"easy",children:"Easy"}),(0,d.jsx)("option",{value:"moderate",children:"Moderate"}),(0,d.jsx)("option",{value:"challenging",children:"Challenging"})]})]})]}),(0,d.jsx)("div",{className:"preferences-actions",children:(0,d.jsx)("button",{onClick:()=>{a({learning_style:"multimodal",experience_level:"intermediate",interests:[],difficulty_preference:"moderate",preferred_examples:[],accessibility_needs:[]})},className:"reset-btn",children:"Reset to Defaults"})})]}),y&&(0,d.jsxs)("div",{className:"error-message",children:["Error: ",y,(0,d.jsx)("button",{onClick:()=>b(null),className:"close-error",children:"\xd7"})]}),C&&_&&(0,d.jsx)("div",{className:"personalized-content",children:(0,d.jsx)(h,{content:_})})]}):(0,d.jsx)("div",{className:"personalization-container",children:(0,d.jsx)("div",{className:"personalization-header",children:(0,d.jsx)("button",{className:"personalize-btn signin-required",onClick:()=>window.location.href="/signin?redirect="+encodeURIComponent(window.location.pathname),title:"Sign in to personalize content",children:"\ud83d\udd12 Sign In to Personalize"})})})},x=({chapterId:e,chapterContent:n,onTranslate:r})=>{const[s,a]=(0,t.useState)(!1),[i,l]=(0,t.useState)(null),[o,c]=(0,t.useState)(!1),[u,x]=(0,t.useState)(null);return(0,d.jsxs)("div",{className:"translate-container",children:[(0,d.jsx)("button",{className:`translate-btn ${s?"active":""} ${o?"loading":""}`,onClick:async()=>{if(s)return a(!1),void l(null);c(!0),x(null);try{const{siteConfig:t}=(0,p.A)(),s=t.customFields?.backendUrl||"http://localhost:8000",i=await fetch(`${s}/translate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,target_language:"urdu",chapter_id:e})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.json();if(!o.translated_content)throw new Error("Translation was not successful");l(o.translated_content),a(!0),r&&r(o.translated_content)}catch(t){console.error("Translation error:",t),x(t instanceof Error?t.message:"An error occurred during translation")}finally{c(!1)}},disabled:o,title:s?"Show original English content":"Translate to Urdu",children:o?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"spinner"}),"Translating..."]}):s?(0,d.jsx)(d.Fragment,{children:"\ud83c\uddec\ud83c\udde7 English"}):(0,d.jsx)(d.Fragment,{children:"\ud83c\uddf5\ud83c\uddf0 \u0627\u0631\u062f\u0648"})}),u&&(0,d.jsxs)("div",{className:"error-message",children:["Error: ",u,(0,d.jsx)("button",{onClick:()=>x(null),className:"close-error",children:"\xd7"})]}),s&&i&&(0,d.jsxs)("div",{className:"translated-content",children:[(0,d.jsx)("div",{className:"translation-badge",children:(0,d.jsx)("span",{children:"\ud83c\uddf5\ud83c\uddf0 Translated to Urdu"})}),(0,d.jsx)(h,{content:i})]})]})},m=e=>(0,d.jsx)(a.A,{children:()=>(0,d.jsx)(x,{...e})});function j(e){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(a.A,{children:()=>{const n=e.content.metadata.id;e.content.metadata.title;return t.useEffect(()=>{const e=document.querySelector("article");if(!e)return;const t=e.innerText||"",s=document.getElementById("chapter-actions-container");if(s)return;const a=document.createElement("div");a.id="chapter-actions-container",a.style.cssText="display: flex; gap: 10px; margin: 20px 0; padding: 15px; background-color: #f5f5f5; border-radius: 8px; border: 1px solid #ddd;",e.firstChild?e.insertBefore(a,e.firstChild):e.appendChild(a);const l=document.createElement("div");a.appendChild(l);const{createRoot:o}=r(5338);o(l).render((0,d.jsx)(i.PersonalizationProvider,{children:(0,d.jsx)(u,{chapterId:n,chapterContent:t})}));const c=document.createElement("div");a.appendChild(c);return o(c).render((0,d.jsx)(m,{chapterId:n,chapterContent:t})),()=>{s&&s.remove()}},[n]),null}}),(0,d.jsx)(s.A,{...e})]})}}}]);